
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="http://www.colmryan.org/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="http://www.colmryan.org/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="http://www.colmryan.org/theme/font-awesome/css/font-awesome.min.css">


    <link href="http://www.colmryan.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Tomorrow Said Toad Atom">





<meta name="author" content="Colm Ryan" />
<meta name="description" content="I had some trouble setting up a Zynq system with Ubuntu 18.04 base image as the rootfs. The kernel would panic when it handed off to the rootfs: 5.755108] VFS: Mounted root (ext4 filesystem) on device 179:2. [ 5.764260] devtmpfs: mounted [ 5.767397] Freeing unused kernel memory …" />
<meta name="keywords" content="Embedded">

<meta property="og:site_name" content="Tomorrow Said Toad"/>
<meta property="og:title" content="No init system on Ubuntu 18.04 base"/>
<meta property="og:description" content="I had some trouble setting up a Zynq system with Ubuntu 18.04 base image as the rootfs. The kernel would panic when it handed off to the rootfs: 5.755108] VFS: Mounted root (ext4 filesystem) on device 179:2. [ 5.764260] devtmpfs: mounted [ 5.767397] Freeing unused kernel memory …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="http://www.colmryan.org/no-init-system-on-ubuntu-1804-base.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2020-02-10 00:00:00-05:00"/>
<meta property="article:modified_time" content="2020-02-10 00:00:00-05:00"/>
<meta property="article:author" content="http://www.colmryan.org/author/colm-ryan.html">
<meta property="article:section" content="Software"/>
<meta property="article:tag" content="Embedded"/>
<meta property="og:image" content="">

  <title>Tomorrow Said Toad &ndash; No init system on Ubuntu 18.04 base</title>

</head>
<body>
  <aside>
    <div>
      <a href="http://www.colmryan.org">
        <img src="http://www.colmryan.org/theme/img/profile.png" alt="Tomorrow Said Toad" title="Tomorrow Said Toad">
      </a>
      <h1><a href="http://www.colmryan.org">Tomorrow Said Toad</a></h1>

<p>Today I will take life easy...</p>
      <nav>
        <ul class="list">

          <li><a href="http://getpelican.com/" target="_blank">Pelican</a></li>
          <li><a href="http://python.org/" target="_blank">Python.org</a></li>
        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-github" href="http://github.com/caryan" target="_blank"><i class="fa fa-github"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="no-init-system-on-ubuntu-1804-base">No init system on Ubuntu 18.04 base</h1>
    <p>
          Posted on Mon 10 February 2020 in <a href="http://www.colmryan.org/category/software.html">Software</a>


    </p>
  </header>


  <div>
    <p>I had some trouble setting up a Zynq system with <a href="http://cdimage.ubuntu.com/ubuntu-base/releases/18.04.3/release/">Ubuntu 18.04 base image</a> as the rootfs. The kernel would panic when it handed off to the <code>rootfs</code>:</p>
<div class="highlight"><pre><span></span><span class="mf">5.755108</span><span class="err">]</span><span class="w"> </span><span class="nl">VFS</span><span class="p">:</span><span class="w"> </span><span class="n">Mounted</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="p">(</span><span class="n">ext4</span><span class="w"> </span><span class="n">filesystem</span><span class="p">)</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="mi">179</span><span class="err">:</span><span class="mf">2.</span><span class="w"></span>
<span class="o">[</span><span class="n">    5.764260</span><span class="o">]</span><span class="w"> </span><span class="nl">devtmpfs</span><span class="p">:</span><span class="w"> </span><span class="n">mounted</span><span class="w"></span>
<span class="o">[</span><span class="n">    5.767397</span><span class="o">]</span><span class="w"> </span><span class="n">Freeing</span><span class="w"> </span><span class="n">unused</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="nl">memory</span><span class="p">:</span><span class="w"> </span><span class="mi">832</span><span class="n">K</span><span class="w"></span>
<span class="o">[</span><span class="n">    5.785642</span><span class="o">]</span><span class="w"> </span><span class="n">Run</span><span class="w"> </span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">init</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="n">process</span><span class="w"></span>
<span class="o">[</span><span class="n">    5.801110</span><span class="o">]</span><span class="w"> </span><span class="n">Run</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="n">process</span><span class="w"></span>
<span class="o">[</span><span class="n">    5.805797</span><span class="o">]</span><span class="w"> </span><span class="n">Run</span><span class="w"> </span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">init</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="n">process</span><span class="w"></span>
<span class="o">[</span><span class="n">    5.810504</span><span class="o">]</span><span class="w"> </span><span class="n">Run</span><span class="w"> </span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">sh</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="n">process</span><span class="w"></span>
<span class="o">[</span><span class="n">    5.833609</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">drm</span><span class="o">]</span><span class="w"> </span><span class="n">Cannot</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="n">crtc</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">sizes</span><span class="w"></span>
<span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="nl">sh</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span><span class="w"> </span><span class="n">Can</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="k">open</span><span class="w"> </span><span class="n">earlyprintk</span><span class="w"></span>
<span class="o">[</span><span class="n">    5.869633</span><span class="o">]</span><span class="w"> </span><span class="n">Kernel</span><span class="w"> </span><span class="n">panic</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">syncing</span><span class="p">:</span><span class="w"> </span><span class="n">Attempted</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">kill</span><span class="w"> </span><span class="n">init</span><span class="err">!</span><span class="w"> </span><span class="n">exitcode</span><span class="o">=</span><span class="mh">0x00007f00</span><span class="w"></span>
</pre></div>


<p>The console messages were on the mark and indeed none of <code>/sbin/init</code>, <code>/etc/init</code>, <code>/bin/init</code> existed and <code>/bin/sh</code> links to <code>dash</code> which isn't an <code>init</code> system. I was a little mystified as to what changed from 16.04 but finally I discovered a <a href="http://blog.dustinkirkland.com/2018/02/rfc-ubuntu-1804-lts-minimal-images.html">blog post</a> that went over all the additional parts stripped out for the Ubuntu 18.04 minimal image and in particular because containers are king: "This base filesystem tarball also lacks a kernel and an init system, as it's intended to be used inside of a chroot or application container." </p>
<p>Fortunately, after <code>chroot</code> into the <code>rootfs</code> a simple <code>apt-get -y install systemd</code> will setup <code>/sbin/init</code> to link <code>/sbin/init -&gt; /lib/systemd/systemd</code> as it should be for an Ubuntu system. </p>
<p>As a side note I found <a href="https://wiki.gentoo.org/wiki/Chroot">Gentoo Linux Chroot</a> had the right <code>mount</code> incantation for getting <code>apt-get</code> in <code>chroot</code> to behaving nicely.</p>
<div class="highlight"><pre><span></span>$ sudo mount --rbind /dev /mnt/mychroot/dev
$ sudo mount --make-rslave /mnt/mychroot/dev
$ sudo mount -t proc /proc /mnt/mychroot/proc
$ sudo mount --rbind /sys /mnt/mychroot/sys
$ sudo mount --make-rslave /mnt/mychroot/sys
$ sudo mount --rbind /tmp /mnt/mychroot/tmp
</pre></div>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="http://www.colmryan.org/tag/embedded.html">Embedded</a>
    </p>
  </div>





</article>

    <footer>
<p>
  &copy;  2020 - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>
</p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Tomorrow Said Toad ",
  "url" : "http://www.colmryan.org",
  "image": "",
  "description": ""
}
</script>

</body>
</html>